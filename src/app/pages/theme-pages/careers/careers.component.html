<mat-sidenav-container class="mainWrapper">
  <mat-sidenav-content>
    <!-- ------------------------------------------------------------------
    Header
    ------------------------------------------------------------------ -->
    <app-header [filterNavRight]="filterNavRight"></app-header>
<!-- ----------------------------------------------------------------------------------------------------- -->
<!-- Form wizard -->
<!-- ----------------------------------------------------------------------------------------------------- -->
      <div class="container justify-content-center">
        <div class="row">
          <div class="col-12">
            <mat-card class="m-t-30 mat-card-top cardWithShadow position-relative overflow-hidden p-24">
              <h1 class="m-b-24 text-center" *ngIf="!formSubmitted">
                Apply for a <span class="highlight-green">Career Opportunity</span>
              </h1>

              <form [formGroup]="careerForm" *ngIf="!formSubmitted" class="mb-4">
                <div class="col-12">
                  <mat-label class="f-w-600 m-b-8 d-block">Location</mat-label>
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-select formControlName="location_id" required (selectionChange)="onLocationChange(); loadQuestionsIfReady()">
                      <mat-option *ngFor="let loc of filteredLocations" [value]="loc.id">
                        {{ loc.city }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="col-12">
                  <mat-label class="f-w-600 m-b-8 d-block">Role</mat-label>
                  <mat-form-field appearance="outline" class="w-100">
                    <mat-select formControlName="apply_to" required (selectionChange)="onRoleChange(); loadQuestionsIfReady()">
                      <mat-option *ngFor="let option of filteredApplyOptions" [value]="option.id">
                        {{ option.name }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </form>

              <form [formGroup]="answersForm" *ngIf="questions.length > 0 && !formSubmitted" class="m-t-24">
                <div *ngFor="let q of questions" class="m-b-24">
                  <mat-label class="question-text f-s-15 d-block m-b-12">
                    {{ q.question_text }} <span *ngIf="q.required" class="text-danger">*</span>
                  </mat-label>

                  <ng-container [ngSwitch]="q.input_type">

                    <!-- Text -->
                    <mat-form-field *ngSwitchCase="'text'" appearance="outline" class="w-100">
                      <input matInput [formControl]="getFormControl(q.id)" type="text" [required]="q.required" />
                    </mat-form-field>

                    <!-- Number -->
                    <mat-form-field *ngSwitchCase="'number'" appearance="outline" class="w-100">
                      <input matInput [formControl]="getFormControl(q.id)" type="number" [required]="q.required" />
                    </mat-form-field>

                    <!-- Email -->
                    <mat-form-field *ngSwitchCase="'email'" appearance="outline" class="w-100">
                      <input matInput [formControl]="getFormControl(q.id)" type="email" [required]="q.required" />
                    </mat-form-field>
                    
                    <!-- Textarea -->
                    <mat-form-field *ngSwitchCase="'textarea'" appearance="outline" class="w-100">
                      <textarea matInput [formControl]="getFormControl(q.id)" rows="4" [required]="q.required"></textarea>
                    </mat-form-field>

                    <!-- Select -->
                    <mat-form-field *ngSwitchCase="'select'" appearance="outline" class="w-100">
                      <mat-select [formControl]="getFormControl(q.id)" [required]="q.required">
                        <mat-option *ngFor="let opt of q.options" [value]="opt">
                          {{ opt }}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>

                    <!-- Radio -->
                    <div *ngSwitchCase="'radio'">
                      <mat-radio-group [formControl]="getFormControl(q.id)" [required]="q.required">
                        <mat-radio-button *ngFor="let opt of q.options" [value]="opt" class="d-block m-b-8">
                          {{ opt }}
                        </mat-radio-button>
                      </mat-radio-group>
                    </div>

                    <!-- File Upload -->
                    <div *ngSwitchCase="'file'" class="col-12 mb-3">
                      <!-- Hidden File Input -->
                      <input
                        #fileInput
                        type="file"
                        accept="application/pdf,image/png,image/jpeg,video/mp4"
                        (change)="onFileChange($event, q.id)"
                        [required]="q.required"
                        style="display: none"
                      />

                      <!-- Upload Button and File Name -->
                      <div class="d-flex flex-wrap align-items-center">
                        <button
                          mat-raised-button
                          type="button"
                          style="background-color: #92b46c; color: #fff; margin-right: 12px; margin-bottom: 8px"
                          (click)="fileInput.click()"
                        >
                          <mat-icon>upload</mat-icon>
                          Upload File
                        </button>

                        <span *ngIf="fileAnswers[q.id]" class="f-s-16">
                          {{ fileAnswers[q.id]?.name }}
                        </span>
                      </div>

                      <!-- Helper Text -->
                      <div style="margin-top: 4px">
                        <small
                          *ngIf="!fileAnswers[q.id]"
                          class="text-danger"
                          style="display: block; max-width: 100%; word-wrap: break-word;"
                        >
                          Maximum file size is 10GB
                        </small>
                      </div>
                    </div>

                  </ng-container>
                </div>

                <div class="d-flex justify-content-end">
                  <button
                    mat-flat-button
                    type="button"
                    [disabled]="answersForm.invalid"
                    class="submit-btn"
                    style="background-color: #92b46c; color: #fff; margin-right: 8px; margin-bottom: 8px"
                    (click)="submitCareerApplication()"
                  >
                    Submit Application
                  </button>
                </div>
              </form>

              <div
                class="d-flex flex-column justify-content-center align-items-center mt-32"
                *ngIf="formSubmitted"
              >
                <h2>Thanks for your submission!</h2>
                <p>We will get in touch with you shortly.</p>
              </div>
            </mat-card>
          </div>
        </div>
      </div>

<!--     <div class="container justify-content-center">
      <div class="row">
        <div class="col-12">
          <mat-card class="mat-card-top cardWithShadow position-relative overflow-hidden p-16">
            <form [formGroup]="careerForm" class="mb-3">
              <mat-form-field appearance="fill" class="w-100">
                <mat-label>Location</mat-label>
                <mat-select formControlName="location_id" required (selectionChange)="onLocationChange(); loadQuestionsIfReady()">
                  <mat-option *ngFor="let loc of filteredLocations" [value]="loc.id">
                    {{ loc.city }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="fill" class="w-100">
                <mat-label>Role</mat-label>
                <mat-select formControlName="apply_to" required (selectionChange)="onRoleChange(); loadQuestionsIfReady()">
                  <mat-option *ngFor="let option of filteredApplyOptions" [value]="option.id">
                    {{ option.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>
            </form>

            <mat-stepper #stepper *ngIf="!formSubmitted" #stepperRef="matStepper">
              <ng-container *ngIf="stepperRef.selectedIndex as currentIndex">
                <mat-step [stepControl]="answersForm">
                  <form class="m-t-24" [formGroup]="answersForm">
                    <ng-template matStepLabel>Answer questions</ng-template>

                    <ng-container *ngIf="paginatedQuestions?.length && currentIndex !== undefined">
                      <ng-container *ngFor="let q of paginatedQuestions[currentIndex]">
                        <mat-label class="f-s-14 f-w-600 d-block m-b-8">{{ q.question_text }}</mat-label>
                        <mat-form-field appearance="outline" class="w-100 m-b-16">
                          <input matInput [formControl]="getFormControl(q.id)" />
                        </mat-form-field>
                      </ng-container>
                    </ng-container>

                     Navigation buttons 
                    <div class="d-flex justify-content-between m-t-24">
                      <button
                        mat-flat-button
                        class="bg-error text-white"
                        matStepperPrevious
                        *ngIf="currentIndex > 0"
                      >
                        Back
                      </button>
                      <button
                        mat-flat-button
                        matStepperNext
                        [disabled]="!answersForm.valid && currentIndex < paginatedQuestions.length - 1"
                      >
                        Next
                      </button>
                    </div>
                  </form>
                </mat-step>
              </ng-container>
            </mat-stepper>

            Thank you message
            <div
              class="d-flex flex-column justify-content-center align-items-center"
              *ngIf="formSubmitted"
            >
              <h2>Thanks for your submission!</h2>
              <p>We will get in touch with you shortly.</p>
            </div>
          </mat-card>
        </div>
      </div>
    </div> -->

    <!-- ------------------------------------------------------------------
    footer
    ------------------------------------------------------------------ -->

    <app-footer></app-footer>

    <!-- ------------------------------------------------------------------
    end footer
    ------------------------------------------------------------------ -->
  </mat-sidenav-content>

  <!-- ------------------------------------------------------------------
    Mobile Sidebar
    ------------------------------------------------------------------ -->
  <mat-sidenav
    #filterNavRight
    mode="over"
    position="end"
    class="filter-sidebar"
  >
    <div>
      <div class="branding">
        <app-branding></app-branding>
      </div>

      <mat-accordion>
        <mat-expansion-panel class="shadow-none">
          <mat-expansion-panel-header>
            <mat-panel-title class="f-s-16 f-w-500"> Demos </mat-panel-title>
          </mat-expansion-panel-header>
          <div>
            <h5 class="f-s-18 mat-subtitle-1 f-w-600">Different Demos</h5>
            <span>Included with the package</span>
            <div class="row m-t-24">
              @for(demo of demos; track demo.url) {
              <div class="col-lg-3 m-b-16">
                <div>
                  <div class="img-overlay rounded">
                    <img
                      [src]="demo.imgSrc"
                      alt="demos"
                      class="rounded w-100"
                    />
                    <div class="overlay-content">
                      <a href="{{ demo.url }}" mat-flat-button color="primary">
                        Live preview
                      </a>
                    </div>
                  </div>
                  <span class="f-s-14 d-block text-center m-t-8">{{
                    demo.name
                  }}</span>
                </div>
              </div>
              }
            </div>
            <!-- apps -->
            <h5 class="f-s-18 mat-subtitle-1 f-w-600 m-t-24">Different Apps</h5>
            <div class="row m-t-24">
              @for(app of appdemos; track app.name) {
              <div class="col-lg-3 m-t-16">
                <div>
                  <div class="img-overlay rounded">
                    <img [src]="app.imgSrc" alt="apps" class="rounded w-100" />
                    <div class="overlay-content">
                      <a href="{{ app.url }}" mat-flat-button color="primary">
                        Live preview
                      </a>
                    </div>
                  </div>
                  <span class="f-s-14 d-block text-center m-t-8">{{
                    app.name
                  }}</span>
                </div>
              </div>
              }
            </div>
          </div>
        </mat-expansion-panel>
        <mat-expansion-panel class="shadow-none">
          <mat-expansion-panel-header>
            <mat-panel-title class="f-s-16 f-w-500"> Pages </mat-panel-title>
          </mat-expansion-panel-header>
          <div>
            <div class="row">
              @for(appdd of apps; track appdd.title) {
              <div class="col-12 text-hover-primary">
                <a
                  [routerLink]="[appdd.link]"
                  class="d-flex align-items-center text-decoration-none m-b-24"
                >
                  <button
                    mat-mini-fab
                    class="text-primary bg-light-primary shadow-none rounded"
                  >
                    <img [src]="appdd.img" width="20" />
                  </button>

                  <div class="m-l-16">
                    <h5
                      class="f-s-14 f-w-600 m-0 textprimary mat-body-1 hover-text"
                    >
                      {{ appdd.title }}
                    </h5>
                    <span class="mat-body-1 f-s-12">{{ appdd.subtitle }}</span>
                  </div>
                </a>
              </div>
              }
            </div>
            <h4 class="f-s-18 f-w-600 mat-subtitle-1 m-b-16">Quick Links</h4>
            @for(quicklink of quicklinks; track quicklink.title) {
            <div class="text-hover-primary">
              <a
                [routerLink]="['quicklink.link']"
                class="hover-text text-decoration-none mat-body-1 f-w-600 d-block p-y-8"
                >{{ quicklink.title }}</a
              >
            </div>
            }
          </div>
        </mat-expansion-panel>
      </mat-accordion>

      <div class="p-x-16">
        <a
          href="
            https://demos.wrappixel.com/premium-admin-templates/angular/spike-angular/docs/index.html
          "
          class="d-flex align-items-center text-decoration-none mat-body-1 p-y-16"
        >
          <span class="f-s-15 f-w-500 m-l-8">Documentation</span>
        </a>
        <a
          [routerLink]="['https://support.wrappixel.com/']"
          class="d-flex align-items-center text-decoration-none mat-body-1 p-y-16"
        >
          <span class="f-s-15 f-w-500 m-l-8">Support</span>
        </a>
        <app-button [fullWidth]="true" class="m-t-16 w-100" text="Login" variant="ghost" size="small" [routerLink]="['/authentication/login']"></app-button>
        <app-button [fullWidth]="true" class="m-t-16 w-100" text="Get Started" variant="filled" size="small"></app-button>
      </div>
    </div>
  </mat-sidenav>
</mat-sidenav-container>
