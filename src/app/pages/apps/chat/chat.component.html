<mat-card class="mat-card-top cardWithShadow communication-container">
  <ng-template #customMenu>
    <div style="display: flex; gap: 12px; margin-right: 5px;">
      <button [ngStyle]="getButtonStyle()" (click)="startVoiceCall()">
        <img src="assets/images/Audio-Call2x.svg" [ngStyle]="getButtonIconStyle()" alt="Voice Call" />
      </button>
      <button [ngStyle]="getButtonStyle()" (click)="startVideoCall()">
        <img src="assets/images/Video-call2x.svg" [ngStyle]="getButtonIconStyle()" alt="Video Call" />
      </button>
    </div>
  </ng-template>
  
  @if(chatService.isChatAvailable) {
    <button
      mat-flat-button 
      color="primary" 
      *ngIf="userRole !== '2' || (userId && groupCreatorUserIds.includes(userId))"
      class="m-b-16 m-t-16" 
      (click)="openDialog()" 
      id="create-group-button"
    >
      Create Group
    </button>

    <!-- BASIC PLAN CHAT -->
    <cometchat-groups-with-messages 
      *ngIf="plan && plan.id == 1"
      id="chat-container"
      [backdropStyle]="backdropStyle"
      [hideCreateGroup]="true"
      [messagesConfiguration]="basicMessagesConfig"
    >
    </cometchat-groups-with-messages>
  
    <!-- ESSENTIAL PLAN CHAT -->
    <cometchat-conversations-with-messages 
      *ngIf="plan && plan.id === 2"
      id="chat-container"
      [messagesConfiguration]="essentialMessagesConfig"
      [StartConversationConfiguration]="chatService.contactsConfiguration"
    >
    </cometchat-conversations-with-messages>

    <!-- PROFESSIONAL PLAN CHAT -->
    <cometchat-conversations-with-messages 
      *ngIf="(plan && plan.id === 3) || userRole === '1'"
      id="chat-container"
      [messagesConfiguration]="professionalMessagesConfig"
      [StartConversationConfiguration]="chatService.contactsConfiguration"
    >
    </cometchat-conversations-with-messages>
  }
  @else {
    <div class="cta-message">
      <p>There was an error initializing the chat.</p>
    </div>
  }
</mat-card>