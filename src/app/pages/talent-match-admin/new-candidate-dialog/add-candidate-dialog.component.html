<h2 mat-dialog-title>{{ action == 'edit' ? 'Edit' : 'Add new' }} Candidate</h2>
<mat-dialog-content>
  <form [formGroup]="candidateForm">
    <div class="row">
      <div class="col-12 m-t-5">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" />
          <mat-error *ngIf="candidateForm.get('name')?.invalid"
            >Name is required</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-12 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Email</mat-label>
          <input matInput formControlName="email" />
          <mat-error *ngIf="candidateForm.get('email')?.invalid"
            >Please enter a valid email</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-12 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Skills</mat-label>
          <textarea matInput formControlName="skills"></textarea>
          <mat-error *ngIf="candidateForm.get('skills')?.invalid"
            >Skills are required</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-12 col-md-6 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>English Level</mat-label>
          <mat-select formControlName="english_level">
            <mat-option *ngFor="let level of englishLevels" [value]="level">{{
              level
            }}</mat-option>
          </mat-select>
          <mat-error *ngIf="candidateForm.get('english_level')?.invalid"
            >English level is required</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-12 col-md-6 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Current Position</mat-label>
          <input matInput formControlName="current_position" />
        </mat-form-field>
      </div>
      <div class="col-12 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Vacancy</mat-label>
          <mat-select formControlName="position_id">
            <mat-option
              *ngFor="let position of positions"
              [value]="position.id"
              >{{ position.title }}</mat-option
            >
          </mat-select>
          <mat-error *ngIf="candidateForm.get('position_id')?.invalid"
            >Position is required</mat-error
          >
        </mat-form-field>
      </div>
      <div class="col-12 mb-3">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Location</mat-label>
          <mat-select formControlName="location_id">
            <mat-option
              *ngFor="let location of locations"
              [value]="location.id"
              >{{ location.city }}</mat-option
            >
          </mat-select>
        </mat-form-field>
      </div>
      <!-- Availability checkbox input -->
      <div class="col-12 m-b-16">
        <mat-checkbox formControlName="availability">Currently available</mat-checkbox>
      </div>
      <!-- Update Match Scores Button -->
      <div class="col-12 mb-3" *ngIf="data.candidate && data.candidate.id">
        <button
          mat-raised-button
          type="button"
          style="
            background-color: #92b46c;
            color: #fff;
            margin-right: 8px;
            margin-bottom: 8px;
          "
          (click)="openMatchScoreModal()"
        >
          <mat-icon>score</mat-icon>
          Update Match Scores
        </button>
      </div>
      <!-- CV Upload -->
      <div class="col-12 mb-3">
        <!-- <label>CV (PDF, max 1MB)</label> -->
        <input
          #cvInput
          type="file"
          accept="application/pdf"
          (change)="onCVSelected($event)"
          [required]="!data.candidate"
          style="display: none"
        />
        <button
          mat-raised-button
          type="button"
          style="
            background-color: #92b46c;
            color: #fff;
            margin-right: 8px;
            margin-bottom: 8px;
          "
          (click)="cvInput.click()"
        >
          <mat-icon>upload</mat-icon>
          Upload CV
        </button>
        <span *ngIf="selectedCVFile">{{ selectedCVFile.name }}</span>
        <small *ngIf="!selectedCVFile && !data.candidate" class="text-danger"
          >CV is required</small
        >
      </div>

      <!-- Profile Picture Upload -->
      <div class="col-12 mb-3">
        <!-- <label>Profile Picture (JPG, max 1MB, optional)</label> -->
        <input
          #picInput
          type="file"
          accept="image/jpeg"
          (change)="onProfilePicSelected($event)"
          style="display: none"
        />
        <button
          mat-raised-button
          type="button"
          style="background-color: #92b46c; color: #fff"
          (click)="picInput.click()"
        >
          <mat-icon>upload</mat-icon>
          Upload Picture
        </button>
        <span *ngIf="selectedProfilePicFile">{{
          selectedProfilePicFile.name
        }}</span>
      </div>
    </div>
  </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
  <button
    mat-flat-button
    color="primary"
    (click)="onSubmit()"
    [disabled]="!isCreationAllowed"
  >
    Save
  </button>
  <button mat-button (click)="onCancel()" class="bg-error text-white">
    Cancel
  </button>
</mat-dialog-actions>
